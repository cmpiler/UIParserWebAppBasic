extends layout

block content
  script(src='https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js')
  h1 CMPILERPROS UI Parser Demo
  p Let's start by dragging and dropping a JSON file between the title and this text
  head
    script(src='https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js')
    script.
      $(document).ready(function(){
      $(":file").css("background-color", "blue");
      });
    style.
      body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background-color: #F0F0F0;
      }
  body
    script.
      var dropbox;
      function dragenter(e) {
        e.stopPropagation();
        e.preventDefault();
      }
      function dragover(e) {
        e.stopPropagation();
        e.preventDefault();
      }
      function drop(e) {
        e.stopPropagation();
        e.preventDefault();
        var dt = e.dataTransfer;
        var files = dt.files;
        processFile(files);
      }
      dropbox = document.querySelector("body");
      dropbox.addEventListener("dragenter", dragenter, false);
      dropbox.addEventListener("dragover", dragover, false);
      dropbox.addEventListener("drop", drop, false);

      function processFile(files){
        var file = files[0];
        if(files.length === 0) {
          alert('No files currently selected for upload');
        } else {
          console.log('File uploaded: '+file);

          var r = new FileReader();
          r.readAsText(file);
          r.onloadend = function(){
              console.log("File contents: "+r.result);

              createUI(r.result);
          }
        }

      function createUI(jsonString){
        var json = JSON.parse(r.result);

        for (var key in json) {
          if (json.hasOwnProperty(key)) {
            console.log(json[key]["type"] + ", " +json[key]["locationx"] + ", " + json[key]["text"]);

            var locX = json[key]["locationx"];
            var locY = json[key]["locationy"];
            var text = json[key]["text"];
            var uiType = json[key]["type"];

            addBr();addBr();

            if (uiType === "lbl"){
              addLbl(locX, locY, text);
            }else if (uiType === "btn"){
              addBtn(locX, locY, text);
            }else if(uiType === "txt"){
              addTxt(locX, locY, text);
            }

          }
        }
      }

      var px = "px";
      function addLbl(locX, locY, text){
        var lbl = document.createElement("LABEL"); 
        lbl.id = "lbl"
        var t = document.createTextNode(text);  
        lbl.appendChild(t);
        document.body.appendChild(lbl);
        document.getElementById("lbl").style.left = "100px";
        addBr();addBr();
      }
      function addBtn(locX, locY, text){
        var btn = document.createElement("BUTTON"); 
        btn.style.left = locX+px;
        btn.style.top = locY+px;
        var t = document.createTextNode(text);  
        btn.appendChild(t);
        document.body.appendChild(btn);
        addBr();addBr();
      }
      function addTxt(locX, locY, text){
        var txt = document.createElement("INPUT"); 
        txt.style.left = locX+px;
        txt.style.top = locY+px;
        var t = document.createTextNode(text);  
        txt.appendChild(t);
        document.body.appendChild(txt);
        addBr();addBr();
      }
      function addBr(){
        var br = document.createElement("BR");
        document.body.appendChild(br);
      }

      }
    
  script(src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js', integrity='sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4', crossorigin='anonymous')
  script(src='https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js', integrity='sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1', crossorigin='anonymous')

