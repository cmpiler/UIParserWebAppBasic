extends layout

block content
  script(src='https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js')
  h1 CMPILERPROS UI Parser Demo
  p Let's start by dragging and dropping a JSON file below
  head
    script(src='https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js')
    script.
      $(document).ready(function(){
      $(":file").css("background-color", "blue");
      });
  body
    form(action='')
      input(type='file', name='myfile', accept='.json', id='dropper')
    script.
      var dropbox;
      function dragenter(e) {
        e.stopPropagation();
        e.preventDefault();
      }
      function dragover(e) {
        e.stopPropagation();
        e.preventDefault();
      }
      function drop(e) {
        e.stopPropagation();
        e.preventDefault();
        var dt = e.dataTransfer;
        var files = dt.files;
        processFile(files);
      }
      dropbox = document.querySelector("input");
      dropbox.addEventListener("dragenter", dragenter, false);
      dropbox.addEventListener("dragover", dragover, false);
      dropbox.addEventListener("drop", drop, false);

      function processFile(files){
        var file = files[0];
        if(files.length === 0) {
          alert('No files currently selected for upload');
        } else {
          console.log('File uploaded: '+file);

          var r = new FileReader();
          r.readAsText(file);
          r.onloadend = function(){
              console.log("File contents: "+r.result);

              createUI(r.result);
          }
        }

      function createUI(jsonString){
        var json = JSON.parse(r.result);
        console.log("First value is: " + json.lbl.location);

        for (var key in json) {
          if (json.hasOwnProperty(key)) {
            console.log(json[key]["type"] + ", " +json[key]["location"] + ", " + json[key]["text"]);

            var loc = json[key]["location"];
            var text = json[key]["text"];
            var uiType = json[key]["type"];

            addBr();addBr();

            if (uiType === "lbl"){
              addLbl(loc, text);
            }else if (uiType === "btn"){
              addBtn(loc, text);
            }else if(uiType === "txt"){
              addTxt(loc, text);
            }

          }
        }
      }

      function addLbl(location, text){
        var btn = document.createElement("LABEL"); 
        var t = document.createTextNode(text);  
        btn.appendChild(t);
        document.body.appendChild(btn);
        addBr();addBr();
      }
      function addBtn(location, text){
        var btn = document.createElement("BUTTON"); 
        var t = document.createTextNode(text);  
        btn.appendChild(t);
        document.body.appendChild(btn);
        addBr();addBr();
      }
      function addTxt(location, text){
        var btn = document.createElement("INPUT"); 
        var t = document.createTextNode(text);  
        btn.appendChild(t);
        document.body.appendChild(btn);
        addBr();addBr();
      }
      function addBr(){
        var br = document.createElement("BR");
        document.body.appendChild(br);
      }

      }
    
  script(src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js', integrity='sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4', crossorigin='anonymous')
  script(src='https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js', integrity='sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1', crossorigin='anonymous')

